<section class="main-content">
  <ul class="breadcrumb breadcrumb-style">
    <li class="breadcrumb-item">
      <h5 class="page-title m-b-0">
        {{ 'MENUITEMS.BILLING-MY-PURCHASES.TEXT' | translate }}
      </h5>
    </li>
    <li class="breadcrumb-item bcrumb-1">
      <a routerLink="/dashboard/main"> <i class="fas fa-home font-17"></i></a>
    </li>
    <li class="breadcrumb-item"></li>
  </ul>
  <div class="section-body">
    <div class="row">
      <div class="col-12 col-md-12 col-lg-12">
        <div class="card">
          <div class="card-header">
            <h4>
              {{
              'BILLING-PURCHASES-PAGE.BILLING-PURCHASES-TITLE.TEXT'
              | translate
              }}
            </h4>
          </div>
          <div class="card-body">
            <!-- Templates personalizados definidos fuera del componente -->
            <ng-template #customButtons>
              <ul class="nav justify-content-end">
                <li class="nav-item m-2">
                  <button type="button" class="btn btn-primary" (click)="copyTableData()">
                    <i class="bi bi-clipboard-check"></i>
                    {{ 'BILLING-PURCHASES-PAGE.COPY.TEXT' | translate }}
                  </button>
                </li>
                <li class="nav-item m-2">
                  <button type="button" class="btn btn-primary" (click)="downloadPDF()">
                    <i class="bi bi-printer"></i>
                    {{ 'BILLING-PURCHASES-PAGE.PDF.TEXT' | translate }}
                  </button>
                </li>
              </ul>
            </ng-template>

            <!-- Template personalizado para columna de NÂ° Factura (clickeable) -->
            <ng-template #noBillTemplate let-row="row">
              <div class="col-blue cursor-pointer" (click)="onPrintInvoice(row)">
                {{ row.id }}
              </div>
            </ng-template>

            <!-- Template personalizado para Estado de Factura -->
            <ng-template #billStateTemplate let-row="row">
              <div *ngIf="row.status == true" class="badge-outline col-green">
                {{ 'BILLING-PURCHASES-PAGE.ROW-ACTIVE.TEXT' | translate }}
              </div>
              <div *ngIf="row.status == false" class="badge-outline col-red">
                {{ 'BILLING-PURCHASES-PAGE.ROW-CANCELLED.TEXT' | translate }}
              </div>
            </ng-template>

            <!-- Template personalizado para Estado de Pago -->
            <ng-template #paidStateTemplate let-row="row">
              <div *ngIf="row.state == true" class="badge-outline col-green">
                {{ 'BILLING-PURCHASES-PAGE.ROW-PAID.TEXT' | translate }}
              </div>
              <div *ngIf="row.state == false" class="badge-outline col-red">
                {{ 'BILLING-PURCHASES-PAGE.ROW-NOT-PAID.TEXT' | translate }}
              </div>
            </ng-template>

            <!-- Template personalizado para Modelo -->
            <ng-template #modelTemplate let-row="row">
              <ng-container *ngIf="row.invoicesDetails && row.invoicesDetails.length > 0; else noInvoiceDetail">
                <ng-container *ngFor="let detail of row.invoicesDetails">
                  <div *ngIf="detail.productName" class="badge-outline col-blue">
                    {{ detail.productName }}
                  </div>
                </ng-container>
              </ng-container>
              <ng-template #noInvoiceDetail>
                <div class="badge-outline col-blue">
                  {{ 'BILLING-PURCHASES-PAGE.RECURRING-MODEL.TEXT' | translate }}
                </div>
              </ng-template>
            </ng-template>

            <!-- Template personalizado para Monto Total -->
            <ng-template #totalAmountTemplate let-row="row">
              <div class="col-red">
                {{ row.totalInvoice }}
              </div>
            </ng-template>

            <app-reusable-datatable
              [rows]="rows"
              [columns]="tableColumns"
              [actions]="tableActions"
              [config]="tableConfig"
              [loadingIndicator]="loadingIndicator"
              [customButtons]="customButtons">
            </app-reusable-datatable>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<app-billing-purchases-detail-modal #modalChildDetail></app-billing-purchases-detail-modal>
